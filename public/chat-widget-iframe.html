<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat Widget</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            height: 100vh;
            background: transparent;
            overflow: hidden;
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        .chat-header {
            background: #2563eb;
            color: white;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bot-avatar {
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #2563eb;
            font-weight: bold;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            margin-left: 4px;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .message {
            display: flex;
            gap: 8px;
            max-width: 85%;
        }
        
        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }
        
        .message-content {
            background: #f3f4f6;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .message.user .message-content {
            background: #2563eb;
            color: white;
        }
        
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 8px 12px;
            background: #f3f4f6;
            border-radius: 12px;
            width: fit-content;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: #9ca3af;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        
        .chat-input {
            border-top: 1px solid #e5e7eb;
            padding: 12px 16px;
            display: flex;
            gap: 8px;
        }
        
        .input-field {
            flex: 1;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 14px;
            outline: none;
        }
        
        .input-field:focus {
            border-color: #2563eb;
        }
        
        .send-button {
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .send-button:hover {
            background: #1d4ed8;
        }
        
        .send-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <div class="bot-avatar">ðŸ¤–</div>
            <div>
                <div style="font-weight: 600; font-size: 14px;">AI Assistant</div>
                <div style="font-size: 12px; opacity: 0.9; display: flex; align-items: center;">
                    Online <div class="status-indicator"></div>
                </div>
            </div>
        </div>
        
        <div class="chat-messages" id="messages">
            <div class="message">
                <div class="message-avatar" style="background: #f3f4f6; color: #2563eb;">ðŸ¤–</div>
                <div class="message-content">
                    Hello! I'm your AI assistant. How can I help you today?
                </div>
            </div>
        </div>
        
        <div class="chat-input">
            <input type="text" class="input-field" id="messageInput" placeholder="Type your message..." />
            <button class="send-button" id="sendButton">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22,2 15,22 11,13 2,9"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <script>
        const messagesContainer = document.getElementById('messages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        
        let isTyping = false;
        
        const responses = [
            "I understand your question. Let me help you with that.",
            "That's a great question! Here's what I recommend...",
            "I'd be happy to assist you with that. Let me provide some information.",
            "Thanks for reaching out! I can definitely help you with this.",
            "I see what you're asking about. Here's my suggestion...",
            "Let me look into that for you right away.",
            "I have some insights that might be helpful for your situation.",
            "That's an interesting point. Here's what I think..."
        ];
        
        function addMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : ''}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            if (isUser) {
                avatar.style.background = '#d1d5db';
                avatar.style.color = '#374151';
                avatar.textContent = 'ðŸ‘¤';
            } else {
                avatar.style.background = '#f3f4f6';
                avatar.style.color = '#2563eb';
                avatar.textContent = 'ðŸ¤–';
            }
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            messageContent.textContent = content;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function showTypingIndicator() {
            if (isTyping) return;
            isTyping = true;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message';
            typingDiv.id = 'typing-indicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.style.background = '#f3f4f6';
            avatar.style.color = '#2563eb';
            avatar.textContent = 'ðŸ¤–';
            
            const typingContent = document.createElement('div');
            typingContent.className = 'typing-indicator';
            typingContent.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(typingContent);
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
            isTyping = false;
        }
        
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;
            
            addMessage(message, true);
            messageInput.value = '';
            sendButton.disabled = true;
            
            showTypingIndicator();
            
            // Simulate API delay
            setTimeout(() => {
                hideTypingIndicator();
                const response = responses[Math.floor(Math.random() * responses.length)];
                addMessage(response, false);
                sendButton.disabled = false;
            }, 1000 + Math.random() * 2000);
        }
        
        sendButton.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        messageInput.addEventListener('input', () => {
            sendButton.disabled = !messageInput.value.trim() || isTyping;
        });
        
        // Get client configuration from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const primaryColor = urlParams.get('color') || '#2563eb';
        const clientId = urlParams.get('clientId');
        const agentId = urlParams.get('agentId');
        
        // Apply custom styling
        if (primaryColor !== '#2563eb') {
            document.documentElement.style.setProperty('--primary-color', primaryColor);
            const header = document.querySelector('.chat-header');
            const userMessages = document.querySelectorAll('.message.user .message-content');
            const button = document.querySelector('.send-button');
            
            if (header) header.style.background = primaryColor;
            if (button) button.style.background = primaryColor;
        }
    </script>
</body>
</html>